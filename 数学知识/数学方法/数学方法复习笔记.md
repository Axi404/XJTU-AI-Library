# 引言

## 数值算法概论

某些数学问题在理论上没有解决的方法，解决此类问题必须用数值计算。

某些数学问题在理论上有解决的方法，但是计算量过大，必须寻找新的行之有效的方法。

## 向量和矩阵范数

#### 定义 1.1 

称 $n$ 维实空间 $x \in \mathbf{R}^{n}$ 上的一个函数 $\|\cdot\|$ 为范数，若满足：

1) 非负性: $\|x\| \geq 0,\|x\|=0$ 当且仅当 $x=0$,
2) 齐次性: $\|\alpha x\|=|\alpha|\|x\|, \alpha \in \mathbf{R}$,
3) 三角不等式: $\|x+y\| \leq\|x\|+\|y\|, \forall x, y$ 

$$\|x\|_{p}=\left (\sum_{i=1}^{n}\left|x_{i}\right|^{p}\right)^{\frac{1}{p}}, x=\left (x_{1}, x_{2}, \ldots, x_{n}\right)^{\mathrm{T}} \in \mathbf{R}^{n}$$

几种最简单的情形：

- $1$ -范数: $\|x\|_{1}=\left|x_{1}\right|+\left|x_{2}\right|+\cdots+\left|x_{n}\right|$ 
- $2$ -范数: $\|x\|_{2}=\left (\left|x_{1}\right|^{2}+\left|x_{2}\right|^{2}+\cdots+\left|x_{n}\right|^{2}\right)^{1 / 2}$
- $\infty$ -范数: $\|x\|_{\infty}=\max \left (\left|x_{1}\right|,\left|x_{2}\right|, \cdots,\left|x_{n}\right|\right)$

### 定理 1.1：

在 $n$ 维实向量 $x \in \mathbf{R}^{n}$ 的一切范数都是等价的，即对 $\mathbf{R}^{n}$ 中的任何两种范数 $\|x\|_{\alpha}$ 与 $\|x\|_{\beta}$ 存在两个正数 $c_{1}, c_{2}>0$，使得对任意的向量 $x$，不等式：

$$c_{1}\|x\|_{\beta} \leq\|x\|_{\alpha} \leq c_{2}\|x\|_{\beta}$$


成立。

对于向量的三种常用的范数，有如下的等价关系：

$$\begin{array}{c}
\|x\|_{2} \leq\|x\|_{1} \leq \sqrt{n}\|x\|_{2} \\
\|x\|_{\infty} \leq\|x\|_{1} \leq n\|x\|_{\infty} \\
\|x\|_{\infty} \leq\|x\|_{2} \leq \sqrt{n}\|x\|_{\infty}
\end{array}$$

### 定义 1.2：

设有向量序列 $\left\{x^{(k)} \in R^{n} \mid x^{(k)}=\left (x_{1}^{(k)}, x_{2}^{(k)}, \cdots, x_{n}^{(k)}\right)^{T}\right\}$，若

$$\lim _{k \rightarrow \infty} x_{i}{ }^{(k)}=x_{i}, \quad i=1,2, \cdots, n$$

则称序列 $\left\{x^{(k)}\right\}$ 收玫于向量 $x=\left (x_{1}, x_{2}, \cdots x_{n}\right)^{T}$。

### 定理 1.2：

在空间 $R^{n}$ 中，序列 $\left\{x^{(k)}\right\}$ 收玫于向量 $x$ 的充要条件是存在范数 $\|\cdot\|$ 使得 $\lim _{k \rightarrow \infty}\left\|x^{(k)}-x\right\|=0$。

### 向量范数的其他性质

设有映射 $\emptyset: D \subset \mathbf{R}^{n} \rightarrow \mathbf{R}^{n}$。在后面的章节，我们常常需要判断非线性方程 :

$$X=\emptyset (x), x \in D \subset \mathbf{R}^{n}$$

的解存在唯一性。为此，作为向量范数的一个应用，我们引入不动点原理。方程中的解也称为映射 $\emptyset$ 的不动点，其存在性往往可通过压缩性保障。

### 定义 1.3

设存在向量空间 $\mathbf{R}^{n}$ 中的范数 $\|\cdot\|$ 及常数 $q \in[0,1)$，使得映射 $\emptyset: D \subset \mathbf{R}^{n} \rightarrow \mathbf{R}^{n}$ 在集 $D_{0} \subset D$ 上满足：

$$\|\emptyset (x)-\emptyset (y)\| \leq q\|x-y\|, \forall x, y \in D_{0}$$

则称 $\emptyset$ 为集 $D_{0} \subset D$ 上的具有压缩系数 $q$ 的压缩映射。

### 定理 1.3 

Banach(巴拿赫)压缩映射原理

设 $\emptyset: D \subset \mathbf{R}^{n} \rightarrow \mathbf{R}^{n}$ 是闭集 $D_{0} \subset \mathrm{D}$ 上的压缩映射，且 $\varnothing\left (D_{0}\right) \subset D_{0}$，则 $\emptyset$ 于 $D_{0}$ 上有唯一不动点 $x^{*}$。

### 定义 1.4

称 $n$ 维实空间 $A \in \mathrm{R}^{n \times n}$ 上的一个函数 $\|\cdot\|$ 为范数，若满足：

1) 非负性: $\|\boldsymbol{A}\| \geq 0,\|\boldsymbol{A}\|=0$ 当且仅当 $\boldsymbol{A}=0$，
2) 齐次性: $\|\alpha \boldsymbol{A}\|=|\alpha|\|\boldsymbol{A}\|, \alpha \in \mathbf{R}$，
3) 三角不等式: $\|\boldsymbol{A}+\boldsymbol{B}\| \leq\|\boldsymbol{A}\|+\|\boldsymbol{B}\|, \forall \boldsymbol{A}, \boldsymbol{B} \in \mathrm{R}^{n \times n}$，
4) 矩阵乘法不等式: $\|\boldsymbol{A} \cdot \boldsymbol{B}\| \leq\|\boldsymbol{A}\| \cdot\|\boldsymbol{B}\|, \forall \boldsymbol{A}, \boldsymbol{B} \in \mathrm{R}^{n \times n}$。

$$\|\boldsymbol{A}\|=\sum_{i=1}^{n} \sum_{j=1}^{n}\left|a_{i j}\right|, \boldsymbol{A}=\left (a_{i j}\right) \in \mathbf{R}^{n \times n}$$

几种最简单的情形 :

矩阵 $\boldsymbol{A}$ 的行范数: $\|\boldsymbol{A}\|_{\infty}=\max _{1 \leq i \leq n} \sum_{j=1}^{n}\left|a_{i j}\right|$
矩阵 $\boldsymbol{A}$ 的列范数: $\|\boldsymbol{A}\|_{1}=\max _{1 \leq j \leq n} \sum_{i=1}^{n}\left|a_{i j}\right|$
矩阵 $\boldsymbol{A}$ 的欧几里得范数: $\|\boldsymbol{A}\|_{2}=\sqrt{\lambda_{\text {max }}\left (\boldsymbol{A}^{\mathrm{T}} \boldsymbol{A}\right)}$

$\|\boldsymbol{A} x\|_{p} \leq\|\boldsymbol{A}\|_{p} \cdot\|x\|_{p}$或$\frac{\|\boldsymbol{A} x\|_{p}}{\|x\|_{p}} \leq\|\boldsymbol{A}\|_{p} \quad (p=1,2, \infty)$

### 定义 1.5

给定一种向量范数 $\|x\|_{p}(p=1,2, \infty)$，相应的定义了矩阵的一个非负函数 $f (A)=\|\boldsymbol{A}\|_{p}$，若有

$$\|\boldsymbol{A}\|_{p}=\max _{x \neq 0} \frac{\|\boldsymbol{A} x\|_{p}}{\|x\|_{p}}=\max _{\|x\|_{p}=1}\|\boldsymbol{A} x\|_{p}$$

则称 $\|\boldsymbol{A}\|_{p}$ 为向量范数导出的矩阵范数，也称 $\|\boldsymbol{A}\|_{p}$ 为算子范数。

## 误差

误差是人们用来描述数值计算中近似解的精确程度，是科学计算中的一个十分重要的概念。

### 分类

- 截断误差（truncation error）：在数值运算中运用近似方法表示准确数值运算或数量而引起的，也叫方法误差。
- 舍入误差（round-off error）：由于计算机字长的限制而产生的误差。
- 不与数值方法本身直接相关的误差
	- 模型误差：数学模型的解与实际问题的解之间出现的误差。 
	- 测量误差：在测量具体数据时产生的误差。

### 定义 1.6 

设 $x^{*}$ 为某测量的精确值， $\tilde{x}$ 是它的一个近似值，则称 $E (\tilde{x})=x^{*}-\tilde{x}$ 为近似值 $\tilde{x}$ 的绝对误差，简称误差。

若存在一个正数 $\delta$，使得 $E (\tilde{x})=\left|x^{*}-\tilde{x}\right| \leq \delta$，则称 $\delta$ 为近似值 $\tilde{x}$ 的绝对误差极限。

- 绝对误差可能取正，也可能取负
- 绝对误差的绝对值越小越具有参考价值
- 绝对误差并不能很好地表示近似值的精确度

### 定义 1.7

设 $x^{*}$ 为某测量的精确值， $\tilde{x}$ 是它的一个近似值，则称 $E_{r}(\tilde{x})=\frac{x^{*}-\tilde{x}}{x^{*}} \times 100 \%\left (x^{*} \neq 0\right)$ 为 $\tilde{x}$  的相对误差。

若存在一个正数 $\delta_{r}$，使得 $\left|E_{r}(\tilde{x})\right|=\left|\frac{x^{*}-\tilde{x}}{x^{*}}\right| \leq \delta_{r}$，则称 $\delta_{r}$ 为 $\tilde{x}$ 的相对误差极限。

- 相对误差是一个无名数，没有量纲。
- 相对误差比绝对误差更能反映出误差的特性。

### 定义 1.8

如果近似值 $\tilde{x}$ 的误差不超过某位的半个单位，若该位数字到 $\tilde{x}$ 的第一位非零数字共有 $n$ 位，那么这 $n$ 位数字称为 $\tilde{x}$ 的有效数字。

### 定义 1.9

设 $\tilde{x}$ 是 $x^*$ 的一个近似值，写成规格化形式：

$$\tilde{x}= \pm 10^{k} \times 0 . a_{1} a_{2} \cdots a_{n} \cdots$$

式中 $a_{i}(i=1,2, \cdots)$  是 $0 \sim 9$ 之间的整数，且 $a_{1} \neq 0$，$k$ 为整数。如果 $\left|x^{*}-\tilde{x}\right| \leq \frac{1}{2} \times 10^{k-n}$，则称 $\tilde{x}$ 是 $x^{*}$ 具有 $n$ 位有效数字的近似值。

### 定理 1.5

1) 若 $\tilde{x}$ 有 $n$ 位有效数字，则  $\left|\frac{x^{*}-\tilde{x}}{\tilde{x}}\right| \leq \frac{1}{2 a_{1}} \times 10^{1-n}$ .
2) 若 $\left|\frac{x^{*}-\tilde{x}}{\tilde{x}}\right| \leq \frac{1}{2\left (a_{1}+1\right)} \times 10^{1-n}$，则 $\tilde{x}$ 至少具有 $n$ 位有效数字。

$f\left (x^{*}\right)$ 的近似函数 $f (\tilde{x})$ 的误差限和相对误差限分别有如下估计式：

$$\left\{\begin{array}{c}
\delta f (\tilde{x}) \leq\left|f^{\prime}(\tilde{x})\right| \cdot \delta (\tilde{x}) \\
\delta_{r} f (\tilde{x})=\left|\frac{\delta f (\tilde{x})}{f (\tilde{x})}\right| \leq\left|\frac{f^{\prime}(\tilde{x})}{f (\tilde{x})}\right| \cdot \delta (\tilde{x})
\end{array}\right.$$

式中，假设 $\delta (\tilde{x})$ 为 $\tilde{x}$ 的误差限。

$f\left (x^{*}, y^{*}\right)$ 的近似函数 $f (x, y)$ 的误差限和相对误差限有如下估计式：

$$\left\{\begin{array}{c}
\delta f (\tilde{x}, \tilde{y}) \leq\left|\frac{\partial f (\tilde{x}, \tilde{y})}{\partial x}\right| \cdot \delta (\tilde{x})+\left|\frac{\partial f (\tilde{x}, \tilde{y})}{\partial y}\right| \cdot \delta (\tilde{y}) \\
\delta_{r}|f (\tilde{x}, \tilde{y})|=\left|\frac{\delta f (\tilde{x}, \tilde{y})}{f (\tilde{x}, \tilde{y})}\right|
\end{array}\right.$$

式中，假设 $\delta (\tilde{x})$ 和 $\delta (\tilde{y})$ 为 $\tilde{x}$ 和 $\tilde{y}$ 的误差限。

### 算术运算的传播

$$\begin{array}{c}
\left\{\begin{array}{c}
\delta (\tilde{x} \pm \tilde{y}) \leq \delta (\tilde{x})+\delta (\tilde{y}) \\
\delta_{r}(\tilde{x} \pm \tilde{y}) \leq \frac{\delta (\tilde{x})+\delta (\tilde{y})}{|\tilde{x} \pm \tilde{y}|}
\end{array}\right. \\
\left\{\begin{array}{c}
\delta (\tilde{x} \tilde{y}) \leq|\tilde{y}| \delta (\tilde{x})+|\tilde{x}| \delta (\tilde{y}) \\
\delta_{r}(\tilde{x} \tilde{y}) \leq \frac{\delta (\tilde{x})}{|\tilde{x}|}+\frac{\delta (\tilde{y})}{|\tilde{y}|}=\delta_{r}(\tilde{x})+\delta_{r}(\tilde{y})
\end{array}\right. \\
\left\{\begin{array}{c}
\delta\left (\frac{\tilde{x}}{\tilde{y}}\right) \leq \frac{1}{|\tilde{y}|} \delta (\tilde{x})+\left|\frac{\tilde{x}}{\tilde{y}^{2}}\right| \delta (\tilde{y}) \\
\delta_{r}\left (\frac{\tilde{x}}{\tilde{y}}\right) \leq \frac{\delta (\tilde{x})}{|\tilde{x}|}+\frac{\delta (\tilde{y})}{|\tilde{y}|}=\delta_{r}(\tilde{x})+\delta_{r}(\tilde{y})
\end{array}\right.
\end{array}$$

对于某个数值算法，如果输入数据的误差，在计算过程中不断扩大而难以得到控制，则称该算法是数值不稳定的，否则是数值稳定的。如果某算法在一定条件下才是数值稳定的，则称该算法是条件稳定（相对稳定）的。若在任何条件下，某算法都是数值稳定的，则称该算法是无条件稳定（绝对稳定）的。

数值计算原则：

- 避免两个相近数相减
- 避免用绝对值过小的数做除数
- 要防止大数“吃掉”小数
- 简化计算步骤，提高计算效率
- 使用数值稳定的算法

# 非线性方程的数值解

## 二分法

首先把区间 $\left[a_{0}, b_{0}\right]$ 二等分，取区间 $\left[a_{0}, b_{0}\right]$ 的中点 $x_{0}=   \frac{1}{2}\left (a_{0}+b_{0}\right)$，计算函数值 $f\left (x_{o}\right)$。如果 $f\left (x_{o}\right)=0$，则求得实根 $x^{*}=\frac{1}{2}\left (a_{0}+b_{0}\right)$；否则 $f\left (x_{o}\right)$ 或者与 $f\left (a_{0}\right)$ 异号，或者与 $f\left (b_{0}\right)$ 异号。

若 $f\left (a_{0}\right) \cdot f\left (x_{o}\right)<0$，则说明根在区间 $\left[a_{0}, x_{0}\right]$ 内，这时取 $a_{1}=a_{0}$，$B_{1}=x_{0}=\frac{a_{0}+b_{0}}{2}$，若 $f\left (x_{o}\right) \cdot f\left (b_{0}\right)<0$，则说明根在区间 $\left[x_{0}, b_{0}\right]$ 内，这时取 $a_{1}=x_{o}=   \frac{a_{0}+b_{0}}{2}, b_{1}=b_{0}$。

由于

$$\left|x^{*}-x_{k}\right| \leq \frac{1}{2}\left (b_{k}-a_{k}\right)=\frac{1}{2^{k+1}}(b-a)$$


对于预先给定的精度 $\varepsilon>0$，只要

$$\begin{array}{c}
\left|\frac{1}{2^{k+1}}(b-a)\right|<\varepsilon \\
\left|\frac{1}{2^{k}}\right|<\frac{2 \varepsilon}{b-a}, \quad 2^{k}>\frac{b-a}{2 \varepsilon}
\end{array}$$

即当 $k>\frac{\ln (b-a)-\ln 2 \varepsilon}{\ln 2}$ 时，则有

$$\left|x^{*}-x_{k}\right|<\varepsilon$$

此时， $x_{k}$  就是满足精度要求的近似值。